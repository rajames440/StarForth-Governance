# StarForth Governance In_Basket

**Purpose:** Mailroom for all governance artifacts generated by StarForth

**Model:**
- StarForth = Mailslot (anyone creates issues, PRs, etc.)
- in_basket = Mailroom (temporary holding area)
- StarForth-Governance Jenkins = Gatekeeper (intelligent sort and route)
- Reference/ = Permanent vault (immutable archives)
- PM = Ultimate arbitrator

---

## Current Contents

### CAPA Vault Integration System

Complete immutable audit trail for CAPAs with 4 components:

#### 1. **CAPA_VAULT_SNAPSHOT_WORKFLOW_SPEC.md**
- **Type:** Specification
- **Purpose:** Detailed technical specification for what the system captures
- **Audience:** Developers, governance team
- **Use:** Reference during implementation, include in documentation
- **Size:** ~3,000 lines
- **Covers:**
  - Workflow triggers (all points where snapshots are created)
  - Data capture (issue body, comments, Kanban state)
  - AsciiDoc snapshot schema
  - MANIFEST.json structure
  - Immutability guarantees
  - Testing procedures

#### 2. **capa-vault-snapshot.yml**
- **Type:** GitHub Actions Workflow (YAML)
- **Purpose:** Captures immutable snapshots at every CAPA state transition
- **Where to install:** `.github/workflows/capa-vault-snapshot.yml` in StarForth-Governance
- **Triggered by:**
  - Manual dispatch (for testing)
  - PR opened/closed in StarForth
  - Issue comments with approval keywords
  - Repository dispatch webhook
- **What it does:**
  1. Fetches CAPA issue from StarForth repo
  2. Gets all comments (complete history)
  3. Queries Kanban Status from Project V2
  4. Generates AsciiDoc snapshot
  5. Creates MANIFEST.json
  6. Commits snapshot to in_basket/CAPAs/
- **Size:** ~350 lines YAML

#### 3. **Jenkinsfile.capa-vault-processor**
- **Type:** Jenkins Pipeline (Groovy)
- **Purpose:** Processes CAPA snapshots from in_basket, archives to permanent vault
- **Where to install:** Reference in Jenkins job configuration (path: in_basket/Jenkinsfile.capa-vault-processor)
- **Triggers:**
  - Daily at 3 AM UTC
  - Manual trigger
  - Webhook on in_basket changes (optional)
- **What it does:**
  1. Scans in_basket/CAPAs/ for MANIFEST.json
  2. For CLOSED CAPAs: archives to Reference/Quality/CAPAs/
  3. Generates COMPLIANCE_CERT.adoc
  4. Creates immutability SHA256 manifest
  5. Verifies checksums
  6. Commits to permanent vault
  7. Notifies PM of exceptions
- **Size:** ~350 lines Groovy

#### 4. **IMPLEMENTATION_GUIDE.md**
- **Type:** Implementation Guide
- **Purpose:** Step-by-step instructions for setting up the system
- **Audience:** DevOps, Jenkins admins, governance implementers
- **Contains:**
  - 6 implementation steps (copy files, set secrets, create jobs, test)
  - GitHub secret configuration
  - Jenkins job setup
  - Testing procedures
  - Troubleshooting guide
  - Success criteria
- **Time to implement:** 2-4 hours
- **Size:** ~500 lines

---

## System Architecture

```
StarForth Repo (Mailslot)
  │
  ├─ CAPA #75 created (GitHub Issue)
  ├─ CAPA #75 moves to IMPLEMENT (PR opened with "Closes #75")
  ├─ CAPA #75 moves to VALIDATE (Tests pass)
  ├─ CAPA #75 moves to APPROVE (Comment: "✅ QA Approved")
  ├─ CAPA #75 moves to RELEASE (Comment: "✅ PM Release")
  └─ CAPA #75 moves to CLOSED (PR merged)
       │
       ↓ (GitHub Actions workflow triggers at each step)
       │
StarForth-Governance Repo (Mailroom + Gatekeeper)
  │
  ├─ in_basket/CAPAs/CAPA-75/
  │  ├─ CAPA-75-created.adoc          [Snapshot 1]
  │  ├─ CAPA-75-implementing.adoc      [Snapshot 2]
  │  ├─ CAPA-75-validated.adoc         [Snapshot 3]
  │  ├─ CAPA-75-approved.adoc          [Snapshot 4]
  │  ├─ CAPA-75-released.adoc          [Snapshot 5]
  │  ├─ CAPA-75-closed.adoc            [Snapshot 6]
  │  └─ MANIFEST.json                  [Index of all snapshots]
  │
  │   (Daily Jenkins processing)
  │
  └─ Reference/Quality/CAPAs/CAPA-75/ (Permanent Archive)
     ├─ CAPA-75-created.adoc
     ├─ CAPA-75-implementing.adoc
     ├─ CAPA-75-validated.adoc
     ├─ CAPA-75-approved.adoc
     ├─ CAPA-75-released.adoc
     ├─ CAPA-75-closed.adoc
     ├─ MANIFEST.json
     ├─ COMPLIANCE_CERT.adoc             [Immutability certificate]
     ├─ index.adoc                       [Archive index]
     └─ .immutability_checksums          [SHA256 verification]

PM Role:
  ✓ Notified of all actions (GitHub + email)
  ✓ Only intervenes for exceptions
  ✓ Ultimate arbitrator for unresolvable items
  ✓ Never manually touches vault
```

---

## What Gets Captured (Immutably)

**Each snapshot contains:**

1. **Complete Issue Metadata**
   - Issue number (#75)
   - Title
   - Author
   - Creation timestamp
   - Closure timestamp
   - Assignees
   - Labels

2. **Original Description**
   - Full issue body (unchanged)
   - Complete at snapshot time

3. **All Comments**
   - Every comment ever posted
   - Author of each comment
   - Timestamp of each comment
   - Chronological order
   - Approval comments preserved

4. **Kanban State**
   - Current state at snapshot time
   - State change history
   - Timestamps for each transition

5. **Approval Chain**
   - Who approved what, when
   - QA approval details
   - PM approval details
   - Version numbers

6. **Related Documents**
   - ECR/ECO references (if applicable)
   - FMEA references (if applicable)
   - BUILD_MANIFEST reference
   - Release Notes reference

---

## File Format: AsciiDoc

**Why AsciiDoc?**
- Governance standard format
- Human-readable source
- Converts to HTML/PDF
- Version control friendly
- Semantic document structure

**Example snapshot file:** `CAPA-75-released.adoc`

```asciidoc
= CAPA #75: Fix emoji parsing in REPL
:docid: CAPA-75
:snapshot-id: CAPA-75-released
:state: RELEASED

== Snapshot Metadata
* State: RELEASED
* Created: 2025-11-02T21:30:00Z

== Original Issue Description
[Original body preserved exactly]

== All Comments (Complete History)
=== Comment by @carol at 2025-11-02T10:00:00Z
✅ QA Approved
Validation complete...

=== Comment by @pm at 2025-11-02T21:30:00Z
✅ PM Release v2.0.1
Approved for production...
```

---

## Compliance Guarantees

✅ **Complete History**
- Every state transition captured
- All comments preserved
- Full approval chain documented

✅ **Immutability**
- Git prevents deletion
- Checksums verify authenticity
- New snapshots only append, never overwrite

✅ **Archival**
- Automatic routing to permanent vault
- Compliance certificates generated
- Immutability verified before archival

✅ **Notifications**
- Stakeholders alerted to all actions
- PM only handles exceptions
- GitHub + email notifications

---

## Implementation Timeline

| Phase | Duration | Component | Status |
|-------|----------|-----------|--------|
| **Setup** | 2-4 hours | Copy files, set secrets | READY |
| **Testing** | 1-2 hours | Manual trigger testing | READY |
| **Integration** | 1 hour | Enable auto-triggers | READY |
| **Monitoring** | Ongoing | Daily Jenkins runs | READY |

**Total:** ~4-6 hours to full production

---

## Next Steps

### For Implementation Team:

1. **Read specification:**
   - `CAPA_VAULT_SNAPSHOT_WORKFLOW_SPEC.md`

2. **Follow implementation guide:**
   - `IMPLEMENTATION_GUIDE.md`
   - Step 1: Copy workflow YAML
   - Step 2: Set GitHub secrets
   - Step 3: Create Jenkins job
   - Step 4: Test manually

3. **Enable automation:**
   - Automatic triggers on state changes
   - Daily Jenkins processing
   - Stakeholder notifications

### For PM:

1. **Monitor first week:**
   - Verify snapshots created
   - Check Jenkins daily runs
   - Review exception notifications

2. **Verify immutability:**
   - Check checksums
   - Review archived CAPAs
   - Spot-check compliance certs

3. **Go live:**
   - Enable email notifications
   - Announce to team
   - Monitor for first 2 weeks

---

## Files in This Directory

```
in_basket/
├── README.md                                    [This file]
├── CAPA_VAULT_SNAPSHOT_WORKFLOW_SPEC.md        [Technical specification]
├── capa-vault-snapshot.yml                      [GitHub Actions workflow]
├── Jenkinsfile.capa-vault-processor             [Jenkins pipeline]
└── IMPLEMENTATION_GUIDE.md                      [Setup instructions]
```

---

## Document Status

| Document | Version | Status | Last Updated |
|----------|---------|--------|--------------|
| CAPA_VAULT_SNAPSHOT_WORKFLOW_SPEC.md | 1.0 | SPECIFICATION | 2025-11-02 |
| capa-vault-snapshot.yml | 1.0 | READY | 2025-11-02 |
| Jenkinsfile.capa-vault-processor | 1.0 | READY | 2025-11-02 |
| IMPLEMENTATION_GUIDE.md | 1.0 | READY | 2025-11-02 |

---

## Support

- **Questions about system:** See CAPA_VAULT_SNAPSHOT_WORKFLOW_SPEC.md
- **How to implement:** See IMPLEMENTATION_GUIDE.md
- **Workflow code:** See capa-vault-snapshot.yml comments
- **Jenkins pipeline:** See Jenkinsfile.capa-vault-processor comments
- **Issues:** Check GitHub Actions logs and Jenkins console

---

**Status: ✅ READY FOR IMPLEMENTATION**

All files are complete, documented, and ready to be deployed to the StarForth-Governance repository.

The system implements the "mailroom" model:
- **StarForth** = Mailslot (anyone creates issues)
- **in_basket** = Temporary mailroom (snapshots dropped here)
- **Jenkins** = Intelligent gatekeeper (routes and archives)
- **Reference/** = Permanent vault (immutable)
- **PM** = Arbitrator (only for exceptions)

**Immutable audit trail for compliance: COMPLETE** ✅
== Signatures

|===
| Signer | Status | Date | Signature

| rajames440 | Pending |  |
|===
